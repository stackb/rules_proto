load("@bazel_gazelle//:def.bzl", "gazelle_binary")
load("@build_stack_rules_proto//rules:proto_gazelle.bzl", "DEFAULT_LANGUAGES", "proto_gazelle")

# gazelle:prefix github.com/corp/repo
# gazelle:go_generate_proto false
# gazelle:proto_language go enabled true

gazelle_binary(
    name = "gazelle-protobuf",
    languages = DEFAULT_LANGUAGES,
)

proto_gazelle(
    name = "gazelle",
    cfgs = ["//:config.yaml"],
    command = "update",
    data = [":generated_data"],
    gazelle = ":gazelle-protobuf",
    imports = ["@googleapis//:imports.csv"],
)

genrule(
    name = "generated_data",
    outs = ["genfile_should_be_present_in_gazelle_data_runfiles.txt"],
    cmd = """
echo -n 'hello, world!' > $@
    """,
)

exports_files(["config.yaml"])
